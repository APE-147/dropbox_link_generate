# PLAN（题单与阶段进度，系统追加）
- 说明：每轮将以块状在文末追加 6–8 个问题、默认选项与效果；题号累计。
- 数据源：docs/REQUIRES.md（只读）、AGENTS.md、代码树
---

基于REQUIRES.md的分析，项目需要实现一个名为`dplk`的命令行工具，功能要求如下：

核心功能：
- 接收文件路径作为命令行参数
- 验证文件是否在Dropbox目录下
- 如果是，生成共享链接并返回
- 如果不是，返回错误并退出

已确定的方案选择：
1. 优先级权重：保持现有权重（方案A）
2. 目标用户：个人快速分享（方案A）
3. 凭据方式：.env 读取 DROPBOX_TOKEN 调用官方API（方案A）
4. 执行形态：纯Python CLI（dplk 入口）（方案A）
5. 路径判定：.env 指定唯一 DROPBOX_ROOT 严格校验（方案A）
6. 链接权限：持链接即可访问（无密码/不过期）（方案A）
7. 已存在共享：复用已有链接（幂等）（方案A）
8. 输出方式：仅打印URL，自动复制到剪贴板（方案A的变体）
9. 输入范围：仅单文件路径（方案A）
10. 符号链接：仅在Dropbox根内才跟随（方案C）
11. 错误处理：统一非零退出码=1，明确短文案（方案A）
12. 同步状态：不等待本地同步，直接创建/复用链接（方案A）
13. 链接粒度：仅文件级链接（方案A）
14. 缓存策略：不落盘缓存，实时查询API复用（方案A）
15. 分发方式：仅本地使用（非PyPI分发）
16. 多账号：单账号默认（方案A）
17. 输出格式：纯URL（默认打印）（方案A）
18. 剪贴板：内置 --copy（pyperclip+系统回退）（方案A）
19. 重试策略：5s超时+1次快速重试（方案A）
20. 代理支持：不支持代理（方案C）
21. 平台支持：macOS+Linux优先（方案A）
22. 链接类型：直链原始渲染（?raw=1）（方案C）
23. 速率限制：捕获429并指数退避（方案A）
24. 日志记录：默认仅URL；--verbose/--log-file 可选（方案A）

[S1｜完成度 20%]